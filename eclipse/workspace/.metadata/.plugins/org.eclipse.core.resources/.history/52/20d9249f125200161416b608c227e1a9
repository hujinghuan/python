# -*- coding: utf-8 -*-
import pandas as pd
import numpy as np
import numexpr as nep

df = pd.read_excel("sample-salesv3.xlsx")
print(df.dtypes)
df['date'] = pd.to_datetime(df['date'])
print(df.head())
print(df.dtypes)
print(df[df["account number"]==307599].head())#筛选account number=307599的记录
print(df[df["quantity"]>22].head())
print(df[df["sku"].map(lambda x: x.startswith('B1'))].head())#筛选sku中以B1开头的记录，lambda=λ
print(df[df["sku"].map(lambda x: x.startswith('B1')) & (df["quantity"]>22)].head())#；两个条件用&链接即可
print(df[df["account number"].isin([714466,218895])].head())

df.query('name == ["Kulas Inc","Barton LLC"]')
print(df.query)

df = df.sort_values(by='date')
print(df.head())
print(df[df['date'] >='20140905'].head())