# -*- coding: utf-8 -*-

import pandas as pd
import numpy as np

df = pd.read_excel('sales-funnel.xlsx')
print(df.head())

df["Status"] = df["Status"].astype("category") #把status的type设置为category
df["Status"].cat.set_categories(["won","pending","presented","declined"],inplace=True)#设置category内容

print(pd.pivot_table(df,index=["Manager","Rep"]))#设置manger,rep为pivot_table的index，直接汇总
print(pd.pivot_table(df,index=["Manager","Rep"],values=["Price"]))#精简表格，只留下price这列，默认price取的平均值
print(pd.pivot_table(df,index=["Manager","Rep"],values=["Price"],aggfunc=np.sum))